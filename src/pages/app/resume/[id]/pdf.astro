---
import { actions } from "astro:actions";

export const prerender = false;

const resumeId = Astro.params.id;
const resumeResult = await actions.getResume({ id: resumeId });
const resume = {
  id: resumeId,
  title: resumeResult.data?.resume?.title ?? "Senior Product Manager (Fintech)",
  name: "Amina Rahman",
  role: resumeResult.data?.resume?.target_role ?? "Senior Product Manager",
  location: resumeResult.data?.resume?.location ?? "Dubai, UAE",
  email: "amina@example.com",
  phone: "+971 555 1234",
  summary:
    resumeResult.data?.resume?.summary ??
    "Product leader shaping reliable fintech experiences with measurable outcomes, strong collaboration, and recruiter-ready presentation.",
};

const experienceItems = [
  {
    id: "exp1",
    title: "Senior Product Manager",
    company: "Fintech Corp",
    dates: "Jan 2020 – Present",
    location: "Dubai, UAE",
    bullets: [
      "Scaled payments roadmap with risk controls, improving authorization success by 6%.",
      "Partnered with compliance to streamline KYC flows for enterprise clients.",
    ],
  },
  {
    id: "exp2",
    title: "Product Manager",
    company: "Payments Inc.",
    dates: "Jun 2016 – Dec 2019",
    location: "Chennai, India",
    bullets: [
      "Launched onboarding refinements reducing time-to-transaction by 18%.",
      "Guided experimentation program improving activation by 9%.",
    ],
  },
];

const educationItems = [
  {
    id: "edu1",
    degree: "MBA, Product Strategy",
    school: "Global Business School",
    dates: "2014 – 2016",
    location: "Singapore",
  },
];

const skills = [
  "Product Strategy",
  "Roadmapping",
  "Stakeholder Management",
  "Experimentation",
  "Fintech Compliance",
];

const links = [
  { label: "LinkedIn", href: "https://linkedin.com/in/amina" },
  { label: "Portfolio", href: "https://portfolio.example.com" },
];
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Resume – {resume.title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="av-resume-pdf">
    <header class="av-resume-pdf__header">
      <div class="av-resume-pdf__identity">
        <h1 class="av-resume-pdf__name">{resume.name}</h1>
        <p class="av-resume-pdf__role">{resume.role}</p>
        <p class="av-resume-pdf__meta">{resume.location}</p>
      </div>
      <div class="av-resume-pdf__contact">
        <p>{resume.email}</p>
        <p>{resume.phone}</p>
      </div>
    </header>

    <section class="av-resume-pdf__section">
      <h2 class="av-resume-pdf__section-title">Summary</h2>
      <p class="av-resume-pdf__text">{resume.summary}</p>
    </section>

    <section class="av-resume-pdf__section">
      <h2 class="av-resume-pdf__section-title">Work Experience</h2>
      {experienceItems.map((item) => (
        <article class="av-resume-pdf__item">
          <div class="av-resume-pdf__item-header">
            <p class="av-resume-pdf__item-title">{item.title} — {item.company}</p>
            <p class="av-resume-pdf__item-meta">{item.dates} · {item.location}</p>
          </div>
          <ul class="av-resume-pdf__list">
            {item.bullets.map((bullet) => (
              <li>{bullet}</li>
            ))}
          </ul>
        </article>
      ))}
    </section>

    <section class="av-resume-pdf__section">
      <h2 class="av-resume-pdf__section-title">Education</h2>
      {educationItems.map((item) => (
        <article class="av-resume-pdf__item">
          <p class="av-resume-pdf__item-title">{item.degree}</p>
          <p class="av-resume-pdf__item-meta">{item.school} · {item.dates} · {item.location}</p>
        </article>
      ))}
    </section>

    <section class="av-resume-pdf__section">
      <h2 class="av-resume-pdf__section-title">Skills</h2>
      <p class="av-resume-pdf__chips">{skills.join(" · ")}</p>
    </section>

    <section class="av-resume-pdf__section">
      <h2 class="av-resume-pdf__section-title">Links</h2>
      <ul class="av-resume-pdf__links">
        {links.map((link) => (
          <li>
            <span class="av-resume-pdf__link-label">{link.label}:</span>
            <span>{link.href}</span>
          </li>
        ))}
      </ul>
    </section>
  </body>
</html>
